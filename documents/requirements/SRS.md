
# SRS - Содержание
  
**1 [Введение](#intro)**

1.1 [Назначение](#appointment)  
1.2 [Бизнес-требования](#business_requirements)  
1.2.1 [Исходные данные](#initial_data)  
1.2.2 [Возможности бизнеса](#business_opportunities)  
1.2.3 [Границы проекта](#project_boundary)  
1.3 [Аналоги](#analogues)  
  
**2 [Требования пользователя](#user_requirements)**

2.1 [Программные интерфейсы](#software_interfaces)  
2.2 [Интерфейс пользователя](#user_interface)  
2.3 [Характеристики пользователей](#user_specifications)  
2.3.1 [Классы пользователей](#user_classes)  
2.3.2 [Аудитория приложения](#application_audience)    
2.4 [Предположения и зависимости](#assumptions_and_dependencies) 

**3 [Системные требования](#system_requirements)**

3.1 [Функциональные требования](#functional_requirements)  
3.1.1 [Управление библиотекой](#f-lib)  
3.1.2 [Система фильтров библиотеки](#f-filter)  
3.1.3 [Модуль воспроизведения](#f-play)  
3.1.4 [Синхронизация библиотеки с устройствами](#f-sync)  
3.1.5 [Редактирование метаданных](#f-meta)  
3.1.6 [Конвертер аудиофайлов](#f-convert)  
3.1.7 [Переименование файлов](#f-rename)  
3.1.8 [Просмотр информации аудиофайлов](#f-info)  
3.1.9 [Адаптация устаревших систем](#f-legacy)  
3.1.10 [Требования к архитектуре и общим механизмам](#f-arch)  
3.2 [Нефункциональные требования](#nf-req)  
3.2.1 [Атрибуты качества](#nf-quality)  
3.2.1.1 [Требования к удобству использования](#nf-use)    
3.2.1.2 [Требования к безопасности](#nf-seq)  
3.2.1.3 [Требования к производительности](#nf-perf)  
3.2.1.4 [Требования к надежности](#nf-rel)  
3.2.1.5 [Требования к совместимости](#nf-comp)  
3.2.1.6 [Требования к локализации](#nf-loc)  
3.2.2 [Внешние интерфейсы](#nf-ei)  
3.2.3 [Ограничения](#nf-con)  

<a name="intro"/>

# 1 Введение

<a name="appointment"/>

## 1.1 Назначение
В этом документе описаны функциональные и нефункциональные требования к приложению «Продвинутый менеджер библиотеки музыки» для ОС GNU/Linux. Этот документ предназначен для команды, которая будет реализовывать и проверять корректность работы приложения.

<a name="business_requirements"/>

## 1.2 Бизнес-требования

<a name="initial_data"/>

### 1.2.1 Исходные данные

Пользователи GNU/Linux, управляющие большими локальными музыкальными коллекциями, сталкиваются с отсутствием единого инструмента, который бы сочетал мощный функционал по каталогизации с современным и гибким пользовательским интерфейсом. Существующие решения часто представляют собой компромисс:

- **Консольные утилиты** (например, beets) предлагают высокий уровень автоматизации и точности в обработке метаданных, но их использование требует от пользователя технических навыков и работы в командной строке, что неприемлемо для многих.
- **Графические приложения** (Quod Libet, Strawberry, Rhythmbox) либо имеют устаревший или перегруженный интерфейс, либо их функционал для управления библиотекой (фильтрация, пакетная обработка) недостаточно гибок. Система плагинов в некоторых из них не предлагает необходимого уровня кастомизации.  

Это приводит к тому, что пользователь вынужден либо мириться с недостатками одного инструмента, либо использовать несколько программ для разных задач, что неудобно и фрагментирует рабочий процесс.

<a name="business_opportunities"/>

### 1.2.2 Возможности бизнеса

 Проект «Продвинутый менеджер библиотеки музыки» призван решить эту проблему, предоставив пользователям GNU/Linux единое, мощное и настраиваемое приложение. Ключевые преимущества:
 
 - **Объединение функциональности:** Приложение интегрирует в себя продвинутые возможности по управлению библиотекой, ранее доступные в основном в консольных утилитах, в удобный графический интерфейс.
     
 - **Современный и гибкий UI:** Вместо статичных и перегруженных интерфейсов, проект предлагает модульный и полностью настраиваемый UI (вплоть до поддержки пользовательских тем), позволяя каждому пользователю адаптировать рабочее пространство под свои нужды. При этом ключевым приоритетом является интуитивность: пользователь должен освоить базовый функционал в течение нескольких минут после первого запуска, без необходимости изучать документацию.
     
 - **Продуманная модульность:** Развитая система плагинов позволит не только расширять функционал, но и обеспечит качественную интеграцию модулей между собой, создавая единую экосистему для любых задач, связанных с музыкой.

<a name="project_boundary"/>

### 1.2.3 Границы проекта

 **Входит в рамки проекта (Scope):**
 - Разработка десктопного приложения для платформы GNU/Linux.
 - Реализация ядра для управления крупной музыкальной библиотекой (индексация, хранение метаданных).
 - Разработка системы фильтрации и поиска по библиотеке.
 - Создание базового набора модулей: плеер, редактор тегов, конвертер форматов.
 - Проектирование и реализация API для сторонних модулей.
 - Поддержка пользовательской стилизации интерфейса.

 **Не входит в рамки проекта (Out of Scope):**
 - Поддержка ОС Windows и macOS (рассматривается для будущих версий).
 - Интеграция со стриминговыми музыкальными сервисами.
 - Облачная синхронизация библиотеки и настроек.
 - Разработка мобильного клиента.

<a name="analogues"/>

## 1.3 Аналоги

 На рынке существует несколько приложений, решающих схожие задачи, однако предлагаемый проект занимает уникальную нишу:
 - **Audacious:** Является примером качественной реализации системы плагинов и гибкого интерфейса. Однако его панельная компоновка может быть неоптимальной для управления большими библиотеками. Наше приложение будет использовать более современный подход к компоновке UI (например, вкладочный), сохраняя при этом высокий уровень кастомизации.
 - **beets:** Эталонный инструмент для автоматического тегирования и организации файлов. Наш проект ставит целью предоставить аналогичный по мощности функционал, но в рамках интуитивно понятного графического интерфейса, делая его доступным для более широкой аудитории.
 - **Quod Libet / Rhythmbox:** Предлагают базовый функционал по управлению библиотекой, но уступают в гибкости интерфейса и мощности инструментов фильтрации, которые будут реализованы в нашем проекте.


<a name="user_requirements"/>


# 2 Требования пользователя

<a name="software_interfaces"/>

## 2.1 Программные интерфейсы
Приложение взаимодействует со следующими ключевыми внешними системами и библиотеками через их программные интерфейсы (API):

*   **Сетевые интерфейсы:**
    *   **MusicBrainz API:** Используется для получения метаданных об альбомах и композициях. Взаимодействие происходит по протоколу HTTP(S) с использованием REST-подобных запросов.

*   **Интерфейсы системных библиотек:**
    *   **GStreamer:** Используется для всех операций по декодированию, воспроизведению и кодированию (конвертации) аудиофайлов. Приложение будет использовать API библиотеки GStreamer для построения и управления мультимедийными конвейерами (pipelines).
    *   **Chromaprint:** Используется для создания акустических "отпечатков" файлов, которые затем могут быть использованы для идентификации треков через сервис AcoustID.

*   **Интерфейсы операционной системы:**
    *   **D-Bus (MPRIS v2):** Для интеграции с рабочим окружением Linux (отображение в звуковом апплете, управление через мультимедийные клавиши) приложение будет реализовывать стандартный интерфейс MPRIS v2 через системную шину D-Bus.
    *   **Libnotify:** Для отображения нативных системных уведомлений (например, о смене трека).
*    **Интерфейсы системного уровня для работы с файловой системой:**
    *   **POSIX API (системные вызовы):** Приложение использует стандартные системные вызовы (такие как `stat`) для получения низкоуровневых метаданных файлов, в частности, стабильных идентификаторов (inode). Это позволяет реализовать надежное отслеживание перемещений и переименований файлов на поддерживаемых файловых системах.
    *   **Inotify/Fanotify API:** Используется для подписки на события файловой системы в реальном времени, что позволяет приложению мгновенно реагировать на изменения в отслеживаемых директориях без необходимости полного повторного сканирования.

<a name="user_interface"/>

## 2.2 Интерфейс пользователя
### Вводная часть
Основной интерфейс приложения будет построен по вкладочному принципу. Главное окно будет содержать неотключаемую панель управления библиотекой и область для отображения активных модулей (плеер, плейлисты, редактор тегов и т.д.). Пользователь сможет настраивать расположение и видимость модулей. Интерфейс будет поддерживать пользовательские темы оформления.
### Мокапы интерфейса

![Главное окно приложения (Панель каталога)](Main-Catalog.png)

Главное окно приложения

---

![Главное окно приложения (Панель каталога выключенные)](Main-CatalogDisabled.png)

Категория отключенных модулей в панели Каталога

---

![Панель плеера в главном окне](Main-Player.png)

Панель плеера в главном окне приложения

---

![Редактирование фильтра](Filter-Simple.png)

Окно редактирования фильтра

---

![Редактирование фильтра с группами](Filter-Complex.png)

Окно редактирования фильтра с отображением групп (старое)

---

![Окно настроек по умолчанию](Settings-Modules.png)

Окно настроек с вкладкой по умолчанию


<a name="user_specifications"/>

## 2.3 Характеристики пользователей


<a name="user_classes"/>

### 2.3.1 Классы пользователей

| Класс пользователей         | Описание                                                                                                                              |
| :-------------------------- | :------------------------------------------------------------------------------------------------------------------------------------ |
| **Владелец библиотеки**     | Основной и единственный класс пользователя. В зависимости от сценария использования, можно выделить несколько ключевых персон:        |
| *Продвинутый пользователь*  | Активно использует функции каталогизации, пакетного редактирования тегов, конвертации и синхронизации. Ценит гибкость и автоматизацию. |
| *Обычный слушатель*         | В основном использует приложение как музыкальный плеер с удобной медиатекой. Ценит простой и понятный интерфейс.                        |
| *Утилитарист*               | Использует приложение эпизодически для выполнения конкретных задач (например, быстрой конвертации файлов), не углубляясь в управление всей коллекцией. |


<a name="application_audience"/>

### 2.3.2 Аудитория приложения

- **Целевая аудитория:** Технически грамотные пользователи GNU/Linux, владеющие локальными музыкальными коллекциями и заинтересованные в их эффективной организации. Это могут быть аудиофилы, диджеи, давние коллекционеры музыки.
- **Побочная аудитория:** Любые пользователи Linux, которым требуется инструмент для периодической работы с аудиофайлами (конвертация, редактирование тегов) и которые предпочитают использовать для этого одно многофункциональное приложение.


<a name="target_audience"/>

## 2.4 Предположения и зависимости

### Предположения (Assumptions)
*   **Доступность API:** Предполагается, что внешние сетевые API (в частности, MusicBrainz API) будут доступны и работоспособны большую часть времени. Приложение должно корректно обрабатывать случаи их временной недоступности.
*   **Стабильность API:** Предполагается, что форматы запросов и ответов внешних API не будут изменяться без предупреждения со стороны их владельцев.
*   **Понимание модульности:** Предполагается, что пользователь понимает концепцию модульной архитектуры: функционал, предоставляемый конкретным модулем, доступен только тогда, когда этот модуль включен и настроен.

### Зависимости (Dependencies)
*   **Сетевое подключение:** Для работы функций, использующих онлайн-сервисы (например, получение тегов из MusicBrainz), необходимо активное подключение к сети Интернет.
*   **Платформа:** Приложение зависит от операционной системы семейства GNU/Linux. Для реализации ключевого функционала (мониторинг файловой системы в реальном времени, надежное отслеживание файлов) используются специфичные для этой платформы технологии и API (inotify/fanotify, доступ к inode). Корректная работа на других ОС не гарантируется.
*   **Системные библиотеки:** Для работы приложения требуется наличие в системе предустановленных библиотек, предоставляющих ключевой функционал, в частности GStreamer и Chromaprint. Предполагается, что установка этих зависимостей осуществляется пользователем или пакетным менеджером его дистрибутива.


<a name="system_requirements"/>

# 3 Системные требования

<a name="functional_requirements"/>

## 3.1 Функциональные требования

**Архитектурный обзор**

Приложение построено на модульной архитектуре, состоящей из трех основных уровней: Ядра, Базовых модулей и Опциональных модулей.

**1. Подсистемы Ядра (Core Subsystems)**

Это "невидимые" низкоуровневые сервисы, предоставляющие фундаментальную инфраструктуру для всего приложения. Они не имеют собственного UI и служат "фундаментом" и "коммуникациями" для всех модулей.

- **Подсистема управления модулями:** "Дирижёр". Загружает/выгружает модули, управляет их жизненным циклом и ведет реестр их "возможностей" (реализуемых интерфейсов).
- **Шина событий:** "Внутренняя почтовая служба". Обеспечивает асинхронное общение между всеми частями системы, позволяя им взаимодействовать, не зная друг о друге напрямую    
- **Служба хранения (Persistence):** "Хранитель подвала". Единственный компонент, который напрямую работает с файлом базы данных (SQLite). Предоставляет API для создания, чтения, обновления и удаления данных, а также обеспечивает изоляцию данных для опциональных модулей.
- **Служба метаданных:** "Библиотекарь" или "Эксперт по файлам". Единственный компонент, который умеет "читать" и "писать" метаданные (теги, обложки) непосредственно в аудиофайлах. Абстрагирует всех остальных от сложностей форматов ID3, Vorbis и т.д.
- **Служба конфигурации:** "Хранитель настроек". Читает и пишет настройки из конфигурационного файла. Предоставляет API, через который модули могут "декларировать" свои настройки, чтобы их можно было редактировать централизованно.
- **Служба глобальных сочетаний клавиш:** "Системный слушатель". Низкоуровневый сервис, который регистрирует и отлавливает нажатия клавиш на уровне операционной системы.
- **Общий инструментарий (Framework Toolkit):** "Ящик с инструментами". Предоставляет всем модулям набор готовых "кирпичиков": стандартные UI-компоненты (виджет списка треков, диалоги) и утилитарные функции (логгер, HTTP-клиент).
    

**2. Базовые модули (Core Modules)**

Это неотключаемые модули, составляющие основу пользовательского интерфейса и базовой логики. Они являются основными "клиентами" подсистем Ядра.

- **Модуль "Каркас приложения":** "Здание". Создает главное окно, меню, статус-бар и управляет размещением панелей (вкладок) других UI-модулей.
- **Модуль "Библиотека"** — это "Завхоз". Его работа — сканировать диски, обновлять БД, управлять источниками. Он отвечает за то, **ЧТО** лежит в "подвале".
- **Модуль "Фильтры"** — это "Картотека" и "Читальный зал". Его работа — предоставлять UI для создания запросов (фильтров) и **отображать результаты** этих запросов (основная панель со списком треков). Он отвечает за то, **КАК** мы получаем и видим то, что лежит в "подвале".
- **Модуль "Настройки":** "Панель управления". Предоставляет UI для управления конфигурацией. Автоматически генерирует интерфейс на основе настроек, которые декларируют Ядро и все остальные модули.

**3. Опциональные модули (Optional Modules)**

Это отключаемые модули, которые расширяют функционал приложения. В стандартный пакет поставки входят:

- Модуль "Воспроизведение"
- Модуль "Синхронизация с устройствами"
- Модуль "Редактор метаданных"
- Модуль "Конвертер аудио"
- Модуль "Переименование файлов"
- Модуль "Инспектор файлов"
- Модуль "Адаптация для устаревших систем"
- Модуль "Провайдер данных MusicBrainz"
- Модуль "Процессор изображений"
    
Далее в этом документе детально описаны требования для каждого из Базовых и Опциональных модулей, а также для подсистем Ядра.

<a name="f-lib"/>

### 3.1.1 Управление библиотекой
- __F-LIB-1: Управление источниками__
    - _F-LIB-1-1_: Система должна позволять пользователю добавить произвольное количество папок на локальной файловой системе (включая смонтированные сетевые ресурсы, такие как FTP/SFTP) в качестве источника аудиофайлов для музыкальной библиотеки
    - _F-LIB-1-2_: Система должна сканировать папки-источники с бесконечной глубиной рекурсии на наличие аудиофайлов
    - _F-LIB-1-3_: Система должна предотвращать циклические связи при выполнении требования `F-LIB-1-2`, т.е. игнорировать символические ссылки, канонический путь цели которых уже находится в пределах хотя бы одной из папок-источников.
    - _F-LIB-1-4_: Система должна позволять удалить добавленные папки-источники из общего списка, это также должно исключать аудиофайлы, которые принадлежат этому источнику, из аудиобиблиотеки, включая все символические ссылки
    - _F-LIB-1-5_: При обнаружении перемещения файла за пределы источника, необходимо спросить согласие пользователя на исключение аудиофайлов из аудиобиблиотеки. Если происходит отказ, то аудиофайлы сохраняются в аудиобиблиотеке, но должны быть помечены в интерфейсе как "вне источника" любым из доступных способов
    - _F-LIB-1-6_: Система должна обрабатывать символические ссылки в источнике, указывающие на файлы или папки за пределами всех источников, как способ включения внешнего контента в библиотеку: ссылка на внешний файл приводит к добавлению этого файла в библиотеку, а ссылка на внешнюю папку приводит к рекурсивному сканированию этой папки, как если бы она была полноценной папкой в источнике
- __F-LIB-2: Идентификация и отслеживание файлов__
    - _F-LIB-2-1_: Система должна использовать стабильные переносимые идентификаторы файловой системы (для ext4 это inode), если это ею поддерживается. В крайнем случае допускается использование пути как идентификатора, который не является стабильным. 
    - _F-LIB-2-2_: Система должна использовать акустические отпечатки (Chromaprint) как поддерживающий метод идентификации файлов, который не зависит от метаданных или расположения файла. 
    - _F-LIB-2-3_: Если наблюдаются достаточно близкие акустические отпечатки файлов при прочих равных (формат, длина и/или битрейт с допуском), система должна уведомить пользователя о потенциальных дубликатах, предоставив возможность детально сравнить их и принять решение об удалении.
    - _F-LIB-2-4_: При отслеживании файла, добавленного через символическую ссылку, система должна использовать стабильный идентификатор (inode) целевого файла, но логически связывать его присутствие в библиотеке с существованием самой символической ссылки (это касается также ссылки на папку).
- __F-LIB-3: Обновление библиотеки__
    - _F-LIB-3-1_: Система должна предоставлять возможность ручного запуска пересканирования источников с возможностью выбора конкретных для обновления библиотеки
    - _F-LIB-3-2_: На платформе Linux система должна использовать API мониторинга файловой системы (например, inotify) для автоматического обнаружения изменений (добавление, удаление, изменение файлов) в реальном времени, включая символические ссылки
    - _F-LIB-3-3_: Система должна запускать процесс синхронизации при своём запуске, с возможностью прервать этот процесс из интерфейса пользователем
- **F-LIB-4: Отображение** 
    - _F-LIB-4-1_: Система должна предоставлять основной интерфейс ("панель библиотеки") для просмотра и взаимодействия со всеми аудиофайлами, проиндексированными в библиотеке.
- **F-LIB-5: Пакетный импорт файлов**
    - _F-LIB-5-1_: Система должна предоставлять пользователю интерфейс ("Мастер импорта") для организованного добавления новых аудиофайлов в папки-источники библиотеки.
    - _F-LIB-5-2_: Пользователь должен иметь возможность формировать список файлов для импорта путем прямого выбора файлов и папок в файловой системе или загрузки списка файлов из плейлиста (например, в формате M3U, PLS).
    - _F-LIB-5-3_: Для каждого импортируемого пакета файлов пользователь должен иметь возможность указать целевую папку-источник (или подпапку внутри него), куда будут помещены файлы.
    - _F-LIB-5-4_: Пользователь должен иметь возможность выбрать операцию с исходными файлами: копирование (сохранить оригиналы) или перемещение (удалить оригиналы после успешного импорта).
    - _F-LIB-5-5_: Система должна предоставлять механизм для разрешения конфликтов, если файл с таким именем уже существует в целевой папке (опции: пропустить, заменить, переименовать).

<a name="f-filter"/>

### 3.1.2 Система фильтров библиотеки
- **F-FILTER-1: Управление пользовательскими фильтрами**
    - _F-FILTER-1-1_: Система должна предоставлять централизованный интерфейс для создания, редактирования, переименования и удаления пользовательских фильтров.
    - _F-FILTER-1-2_: Пользователь должен иметь возможность применить любой сохраненный фильтр к основной панели библиотеки для отображения соответствующей выборки треков.
    - _F-FILTER-1-3_: Компонент для выбора сохраненного фильтра должен быть комбинированным, позволяя как выбирать фильтр из выпадающего списка, так и вводить его имя с клавиатуры с функцией автодополнения.
- **F-FILTER-2: Типы правил фильтрации**
    - _F-FILTER-2-1_: Фильтры должны поддерживать <u>статический</u> тип правил, позволяющий напрямую включать в выборку конкретные треки
    - _F-FILTER-2-2_: Фильтры должны поддерживать <u>динамический</u> тип правил, позволяющий формировать выборку на основе набора условий
    - _F-FILTER-2-3_: Один фильтр должен иметь возможность комбинировать в себе как статические, так и динамические правила.
- **F-FILTER-3: Конструктор динамических правил**
    - _F-FILTER-3-1_: Система правил должна быть построена на двухуровневой иерархии: "группы" и "правила", где фильтр может содержать одну или несколько групп, а каждая группа может содержать одно или несколько правил
    - _F-FILTER-3-2_: Группы и правила между собой объединяются одним логическим оператором "И" или "ИЛИ"
    - _F-FILTER-3-3_: Пользователь должен иметь возможность применять логический оператор "НЕ" к отдельным правилам или группам правил.
- **F-FILTER-4: Доступные поля для фильтрации по динамическим правилам**
    - _F-FILTER-4-1_: Система должна предоставлять возможность фильтрации по <u>метаданным файловой системы</u>, что включает в себя как минимум:
        1. Дата создания
        2. Дата изменения
        3. Имя файла
        4. Расширение файла (в приоритете над именем файла)
    -  _F-FILTER-4-2_: Система должна предоставлять возможность фильтрации по <u>техническим аудио-атрибутам</u>, что включает в себя, но не ограничено следующим:
        1. Длительность
        2. BPM
        3. Формат аудио
        4. Контейнер формата (имеет приоритет над форматом аудио)
    - _F-FILTER-4-3_: Система должна предоставлять возможность фильтрации по <u>любому стандартному или пользовательскому тегу</u>.
    - _F-FILTER-4-4_: Для упрощения выбора стандартного тега для фильтрации, необходимо сгруппировать их по взаимоисключающим группам. Рекомендованная структура группировки выглядит следующим образом:
        1. Обычные
            - Имя
            - Исполнитель
            - Дата выпуска
            - Жанр
            - Тип релиза
            - Текст
            - Комментарий
		2. Авторские
		    - Композитор
			- Аранжировщик
			- Лирикист
			- Исполнители
		3. Альбомные
		    - Название альбома
		    - Исполнители альбома
		    - Номер трека
		    - Номер диска
		4. Сторонние
		    - ChromaprintID
		    - MusicBrainzID
		    - и т.д.
- **F-FILTER-5: Управление видимостью фильтров**
    - _F-FILTER-5-1_: Каждый сохраненный фильтр должен иметь настраиваемые <u>правила видимости</u>, которые определяют, в каких модулях приложения этот фильтр будет доступен.
	- _F-FILTER-5-2_: По умолчанию, правило видимости для нового фильтра должно быть установлено в "разрешить для всех модулей". 
	- _F-FILTER-5-3_: Пользователь должен иметь возможность изменять правила видимости, используя логику "белого списка" ("разрешить только для...") или "черного списка" ("запретить для...").
	- _F-FILTER-5-4_: Список модулей для настройки видимости должен формироваться динамически на основе активных в программе, исключая отключенные
- **F-FILTER-6: Применение и представление результатов фильтрации**
    - _F-FILTER-6-1_: Система должна предоставлять выделенный интерфейсный блок (например, панель над списком треков) для управления применением фильтров и отображения сводки результатов.
    - _F-FILTER-6-2_: При применении динамического фильтра, система должна разделять все треки в библиотеке на следующие категории:
        - <u>"Точные совпадения"</u>: Треки, которые полностью удовлетворяют всем условиям фильтра.
        - <u>"Неопределенные результаты"</u>: Треки, для которых невозможно однозначно вычислить условие фильтра из-за отсутствия необходимых для проверки метаданных (например, отсутствует тег "Год" при фильтрации по году).
    - _F-FILTER-6-3_: В интерфейсном блоке сводки должно отображаться количество треков в каждой из категорий. Категории с нулевым количеством треков могут не отображаться для экономии места.
    - _F-FILTER-6-4_: Пользователь должен иметь возможность выбрать одну из категорий в сводке ("Точные совпадения" или "Неопределенные результаты"), после чего в основной панели библиотеки должны отображаться только треки из этой выбранной категории.
    - _F-FILTER-6-5_: По умолчанию, после применения фильтра, в основной панели должны отображаться треки из категории "Точные совпадения".
- **F-FILTER-7: Системное использование фильтров**
    - _F-FILTER-7-1_: Механизм фильтров должен использоваться внутри приложения для получения любых выборок из общей библиотеки, в том числе путём генерации временных фильтров
    - _F-FILTER-7-2_: В системе должен быть нередактируемый фильтр "Все", который виден всем модулям и отображает всю библиотеку, название должно быть адаптируемым к локали через средства приложения

<a name="f-play"/>

### 3.1.3 Модуль воспроизведения
- **F-PLAY-1: Базовое управление и отображение**
    - _F-PLAY-1-1_: Система должна предоставлять стандартные элементы управления "Воспроизведение/Пауза".
    - _F-PLAY-1-2_: Система должна позволять переключаться на следующий и предыдущий трек в очереди воспроизведения.
    - _F-PLAY-1-3_: Система должна предоставлять возможность перемотки внутри текущего воспроизводимого трека.
    - _F-PLAY-1-4_: Система должна позволять управлять уровнем громкости воспроизведения.
    - _F-PLAY-1-5_: В интерфейсе плеера должны отображаться базовые метаданные текущего трека, такие как обложка трека, название трека, исполнитель, название альбома
    - _F-PLAY-1-6_: При значении Single (регистронезависимо) в качестве названия альбома, отображаемое значение должно быть локализовано (на русском это "Сингл") к ближайшей поддерживаемой локали, если явно не выбрана иная- **F-PLAY-2: Управление очередью воспроизведения**
    - _F-PLAY-2-1_: Воспроизведение должно производиться по "снимку" - скрытому списку треков, который является настоящей очередью для внутреннего устройства модуля
    - _F-PLAY-2-2_: Порядок и количество треков в "снимке" определяется одной из выбранных <u>стратегий создания снимка</u>:
        1. Линейная: порядок и количествотреков идентично отображаемой очереди
        2. Случайная: порядок треков является результатом перемешивания пользовательской очереди путём равномерного распределения случайности.
        3. Умная: данная стратегия функционирует в динамическом режиме. Снимок логически состоит из одного текущего трека, а следующий трек определяется в реальном времени в соответствии с алгоритмом из `F-PLAY-3` который вызывается триггером окончания снимка, как определено в F-PLAY-2-4.4.
    - _F-PLAY-2-3_: Переход между треками в "снимке" определяется выбранным <u>режимом итерации</u>:
        1. Без повтора: переходит к следующему треку, пока не достигает конца снимка
        2. Повтор одного трека: переходит к текущему треку после его конца
        3. Повтор всей очереди: всегда переходит к следующему треку
    - _F-PLAY-2-4_: Система плеера должна создавать новый "снимок" по выбранной стратегии при любом из следующих событий:
        1. Создание сеанса воспроизведения 
        2. Изменение содержимого отображаемой очереди пользователем
        3. Изменение <u>стратегии создания снимка</u>
        4. Попытка воспроизведения после последнего трека в "снимке"
- **F-PLAY-3: Умное перемешивание**
    - _F-PLAY-3-1_: В дополнение к стандартному, система должна предоставлять "умный" режим перемешивания, который динамически подстраивает порядок воспроизведения.
    - _F-PLAY-3-2_: Логика работы "умного" режима должна соответствовать принципам, изложенным в документе [WeightsRandomizePlayerSystem](https://seventeen.bearblog.dev/weightsrandomizeplayersystem/).
    - _F-PLAY-3-3_: Система должна предоставлять <u>опциональную</u> визуализацию работы алгоритма "умного" перемешивания в интерфейсе отображаемой очереди.
- **F-PLAY-4: Системная интеграция и управление**
    - _F-PLAY-4-1_: Программа должна предоставлять внутренний раздел настроек глобальных сочетаний клавиш в приложении для этого модуля; список действий включает в себя:
        - управление воспроизведением
        - управление звуком в плеере
        - переключение стратегий из `F-PLAY-2-2`
        - переключение режимов из `F-PLAY-2-3`
    - _F-PLAY-4-2_: Программа должна предоставлять возможность настраивать шаг при линейной перемотке с помощью стрелок при фокусе на полосе воспроизведения или глобальных клавиш
    - _F-PLAY-4-3_: Программа должна представлять режим прогрессирующей перемотки, когда базовый шаг, предоставляемый настройкой линейной перемотки, увеличивается в 2 раза спустя фиксированный промежуток времени зажатия клавиши
    - F-PLAY-4-4: Приложение должно реализовывать стандарт MPRIS D-Bus, что обеспечит:
        1. Управление воспроизведением через системные апплеты и уведомления.
        2. Корректную реакцию на стандартные мультимедийные клавиши.

<a name="f-sync"/>

### 3.1.4 Синхронизация библиотеки с устройствами
- **F-SYNC-1: Профили синхронизации**
    -_F-SYNC-1-1_: Пользователь должен иметь возможность создавать, редактировать и удалять <u>профили синхронизации</u>.
    - _F-SYNC-1-2_: Каждый профиль должен быть привязан к цели, используя один или более вариантов из следующих:
	    1. Целевое устройство через его стабильный идентификатор (например, UUID файловой системы) + целевая папка на нём
        2. Статический путь к обычной папке в файловой системе, если это не устройство или его невозможно стабильно идентифицировать
    - _F-SYNC-1-3_: При выборе устройства для профиля, система должна отображать пользователю список всех подключенных в данный момент съемных носителей.
    - _F-SYNC-1-4_: Для каждого устройства в списке должна отображаться вспомогательная информация для опознавания, такая как: метка тома, производитель, модель, название, если эти данные доступны в системе.
    - _F-SYNC-1-5_: При привязке устройства к профилю, система должна сохранять вспомогательную информацию для отображения в интерфейсе и в сообщениях об ошибках.
- **F-SYNC-2: Источник и структура назначения**
	- _F-SYNC-2-1_: Пользователь должен иметь возможность выбрать один или несколько фильтров в качестве источника данных, которые объединяются в единый список.  
	- _F-SYNC-2-2_: Система должна предоставлять несколько стратегий формирования структуры папок в цели:
	    - **Сохранение относительной структуры:** Поведение по умолчанию.
	    - **Группировка по фильтру:** Файлы из каждого фильтра-источника помещаются в отдельную подпапку.
	    - **Пользовательский шаблон:** Структура папок генерируется на основе шаблона с использованием метаданных (например, /<Исполнитель>/<Альбом>/).
	- _F-SYNC-2-3_: Для имен папок, генерируемых на основе имен фильтров, пользователь должен иметь возможность указать ASCII-совместимый псевдоним.
	- _F-SYNC-2-4_: Псевдоним для фильтра сохраняется на уровне модуля в единичном экземпляре и подставляется автоматически в поля, если включается соответствующая настройка в профиле
	- _F-SYNC-2-5_: Если включена настройка ASCII-псевдонимов в профиле, то по умолчанию синхронизация невозможна, если псевдонимы не будут указаны для всех включенных в профиль фильтров
- **F-SYNC-3: Конвейер обработки**
    - _F-SYNC-3-1_: В каждом профиле должна быть возможность настроить pipeline — последовательность операций, применяемых к файлам во время синхронизации.
    - _F-SYNC-3-2_: Список доступных операций должен динамически формироваться из установленных модулей, реализующих соответствующий API.
    - _F-SYNC-3-3_: Исходные файлы в библиотеке <u>не должны изменяться</u> в процессе синхронизации. Все операции применяются к временным копиям.
- **F-SYNC-4: Процесс и безопасность**
    - _F-SYNC-4-1_: Синхронизация должна инициироваться пользователем вручную.
    - _F-SYNC-4-2_: Перед началом копирования система должна показать план синхронизации со списком изменений для подтверждения пользователем.
    - _F-SYNC-4-3_: Система должна поддерживать опциональное удаление "осиротевших" файлов с целевого устройства.
- **F-SYNC-5: Валидация профиля**
    - _F-SYNC-5-1_: При выборе профиля система должна проверять доступность его компонентов, как минимум:
        1. Доступность целевого устройства/папки
        2. Наличие папки внутри целевого устройства
        3. Наличие фильтров
        4. Наличие псевдонимов при активности соответствующих настроек
        5. Наличие модулей предоставляющих этапы для конвейера, которые были выбраны
    - _F-SYNC-5-2_: В случае обнаружения проблем система должна предоставить единое диалоговое окно для опционального исправления проблем "на месте" (например, указать новый путь или удалить невалидную настройку).
    - _F-SYNC-5-3_: Для проблемы "устройство не найдено", в сообщении об ошибке должна присутствовать подсказка для пользователя, указывающая на возможную причину: "Устройство не подключено, либо было отформатировано, что привело к изменению его идентификатора (UUID)".

<a name="f-meta"/>

### 3.1.5 Редактирование метаданных
- **F-META-1: Редактирование тегов**
    - _F-META-1-1_: Модуль должен позволять пользователю выбирать один или несколько треков из библиотеки для пакетного редактирования.
    - _F-META-1-2_: Интерфейс должен корректно отображать общие и различные значения тегов для выбранной группы файлов.
    - _F-META-1-3_: Пользователь должен иметь возможность изменять любые стандартные и пользовательские IDv3 теги, применяя изменения ко всем выбранным файлам.
- **F-META-2: Работа с обложками**
    - _F-META-2-1_: Пользователь должен иметь возможность добавлять, заменять, извлекать и удалять обложку альбома.
    - _F-META-2-2_: Пользователь должен иметь возможность обрабатывать существующую обложку (изменять размер, формат, сжатие).
    - F-META-2-3: Функционал обработки изображений `F-META-2-2` должен предоставляться совместимыми модулями-процессорами изображений, если они установлены.
- **F-META-3: Интеграция с Провайдерами метаданных**
    - _F-META-3-1_: В настройках модуля пользователь должен иметь возможность выбрать активный модуль-провайдер метаданных из списка установленных.
    - _F-META-3-2_: Модуль должен предоставлять функцию для автоматического поиска метаданных с использованием выбранного провайдера.
    - _F-META-3-3_: Перед сохранением полученных данных, система должна показать пользователю диалог сравнения "старых" и "новых" значений для подтверждения.

<a name="f-convert"/>

### 3.1.6 Конвертер аудиофайлов
- **F-CONVERT-1: Интерактивная конвертация**
    - _F-CONVERT-1-1_: Модуль должен предоставлять пользовательский интерфейс для пакетной конвертации файлов.
    - _F-CONVERT-1-2_: В интерфейсе пользователь должен иметь возможность сформировать очередь аудиофайлов через фильтры, выбрать целевой формат, настроить его базовые параметры и указать папку назначения.
    - _F-CONVERT-1-3_: Интерфейс должен отображать детальный прогресс операции.
- **F-CONVERT-2: Автоматизированная конвертация**
    - _F-CONVERT-2-1_: Функционал конвертации должен быть доступен для использования другими модулями (например, "Синхронизацией") в качестве шага в автоматизированных процессах.
    - _F-CONVERT-2-2_: При использовании в автоматизированном режиме, конвертация должна происходить в фоновом режиме, без отображения пользовательского интерфейса и с возможностью узнавать прогресс задачи.
- **F-CONVERT-3: Общие требования к конвертации**
    - _F-CONVERT-3-1_: При конвертации должны сохраняться все метаданные (теги и обложки), если это поддерживается целевым форматом.
    - _F-CONVERT-3-2_: Должна поддерживаться конвертация между основными lossless и lossy форматами.

<a name="f-rename"/>

### 3.1.7 Переименование файлов
- **F-RENAME-1: Интерактивное переименование**
    - _F-RENAME-1-1_: Модуль должен предоставлять пользовательский интерфейс для пакетного и единичного переименования файлов.
    - _F-RENAME-1-2_: В интерфейсе пользователь должен иметь возможность частично или полностью выбрать группу файлов для переименования из результатов фильтра.
    - _F-RENAME-1-3_: Система должна предоставлять предпросмотр, показывающий текущие и будущие имена файлов до применения изменений.
- **F-RENAME-2: Конструктор шаблонов**
    - _F-RENAME-2-1_: Пользователь должен иметь возможность создавать шаблон для нового имени файла, используя предопределенные общепризнанные переменные, соответствующие метаданным трека (например, %artist%, %album%, %track%, %title%).
    - _F-RENAME-2-2_: Конструктор шаблонов должен поддерживать <u>модификаторы для переменных</u>, позволяющие управлять регистром символов (например, верхний, нижний, "как в предложениях", "оригинал").
    - _F-RENAME-2-3_: Пользователь должен иметь возможность сохранять созданные шаблоны под произвольными именами для повторного использования внутри этого модуля.
- **F-RENAME-3: Автоматизированное переименование**
    - _F-RENAME-3-1_: Функционал форматирования имен файлов должен быть доступен для использования другими модулями (например, "Синхронизацией") в качестве шага в автоматизированных процессах.

<a name="f-info"/>

### 3.1.8 Просмотр информации аудиофайлов
- **F-INFO-1: Отображение информации**
    - _F-INFO-1-1_: Пользователь должен иметь возможность открыть окно "Инспектора" для <u>одного</u> выбранного трека в библиотеке.
    - _F-INFO-1-2_: В окне должна отображаться <u>вся доступная</u> информация о файле, которую может получить приложение.
    - _F-INFO-1-3_: Информация должна быть сгруппирована по категориям для удобства чтения, как минимум:
        - **Основные теги** (исполнитель, альбом, жанр и т.д.).
        - **Подробные теги** (все кастомные)
        - **Технические аудио-атрибуты** (формат, битрейт, длительность и т.д.).
        - **Метаданные файловой системы** (разновидность ФС, путь к файлу, размер, дата изменения).
        - **Способ идентификации файла в приложении** (inode (ext4)/строковый путь/FileID (NTFS) + ChromaprintID)
- **F-INFO-2: Взаимодействие**
    - _F-INFO-2-1_: Весь интерфейс "Инспектора" должен быть в режиме "только для чтения". Редактирование данных в этом модуле не предусмотрено.
    - _F-INFO-2-2_: Пользователь должен иметь возможность копировать в буфер обмена отдельные значения полей (например, для копирования Chromaprint ID).
    - _F-INFO-2-3_: Пользователь должен иметь возможность копировать группы значений в табличном виде через отдельное окно выделения полей
    - _F-INFO-2-4_: При комплексном выборе копируемых в буфер значений должна быть возможность сохранения выбора в "профиль" внутри этого модуля

<a name="f-legacy"/>

### 3.1.9 Адаптация для устаревших систем
- **F-LEGACY-1: Основной функционал**
    - _F-LEGACY-1-1_: Модуль должен предоставлять пользовательский интерфейс для выбора файлов и настройки параметров адаптации.
    - _F-LEGACY-1-2_: Пользователь должен иметь возможность выбрать один из предустановленных <u>профилей совместимости</u> (например, "Стандартный MP3-плеер", "Магнитола FAT32") или настроить параметры вручную.
    - _F-LEGACY-1-3_: Результатом работы модуля должны быть новые файлы, сохраненные в указанной пользователем папке. Исходные файлы изменяться не должны.
- **F-LEGACY-2: Параметры адаптации**
    - _F-LEGACY-2-1_: (**Аудиоформат**): Пользователь должен иметь возможность выбрать целевой аудиоформат, как правило, MP3 с постоянным битрейтом (CBR). Эта функция должна использовать "Конвертер аудиофайлов".
    - _F-LEGACY-2-2_: (**Теги**): Пользователь должен иметь возможность настроить преобразование тегов:
        - Принудительное сохранение тегов в максимально совместимой версии (например, ID3v2.3).
        - Удаление нестандартных или слишком больших тегов (например, текстов песен, нескольких обложек).
        - Транслитерация тегов в латиницу (ASCII).
    - _F-LEGACY-2-3_ (**Имена файлов**): Пользователь должен иметь возможность настроить преобразование имен файлов:
        - Удаление или замена символов, несовместимых с FAT32/ISO 9660.
        - Транслитерация имен файлов в латиницу (ASCII).
        - Принудительное приведение к формату 8.3 (опционально, для очень старых систем).
    - _F-LEGACY-2-4_ (**Обложки**): Пользователь должен иметь возможность настроить обработку обложек, например, принудительное изменение размера до 300x300 и конвертацию в JPEG. Эта функция должна использовать "Процессор изображений".

<a name="f-arch"/>

### 3.1.10 Требования к архитектуре и общим механизмам (Ядро)
- **F-ARCH-1: Модульная система**    
    - F-ARCH-1-1: Приложение должно быть построено на **модульной архитектуре**, разделяющей Ядро, Базовые модули и Опциональные модули.
    - F-ARCH-1-2: **Базовые модули** являются неотъемлемой частью приложения. **Опциональные модули** должны быть отдельными компонентами, загружаемыми из определенной директории.
    - F-ARCH-1-3: Ядро должно определять набор **стандартных интерфейсов (API)**, которые модули могут реализовывать для предоставления своей функциональности (например, для интеграции в UI, для предоставления сервисов другим модулям).
    - F-ARCH-1-4: Модуль, реализующий **интерфейс UI**, должен иметь возможность декларировать различные **точки интеграции**: основной виджет (панель), пункты меню, кнопки на панели инструментов, отдельное окно
    - F-ARCH-1-5: **Базовый модуль "Настройки"** должен предоставлять пользователю интерфейс для управления жизненным циклом (включение/отключение) и видимостью точек интеграции опциональных модулей.
    - **F-ARCH-1-6 (Манифест модуля):** Каждый модуль (как базовый, так и опциональный) **должен** предоставлять Ядру свои метаданные в виде стандартизированного "манифеста".
	- **F-ARCH-1-7 (Состав манифеста):** Манифест должен содержать как минимум следующую информацию:
	    - **Стабильный UUID:** Уникальный идентификатор, который **не меняется** между версиями одного и того же модуля. Используется Ядром для внутреннего отслеживания и управления данными модуля.
	    - **Уникальный строковый идентификатор:** Человекочитаемый идентификатор в формате обратной нотации (например, org.example.audioconverter). Используется для логов, конфигурационных файлов и для объявления зависимостей между модулями.
	    - **Версия модуля:** Версия в формате семантического версионирования (SemVer, например, 1.2.0).
	    - **Дата выпуска:** Дата релиза данной версии модуля.
	    - **Локализуемое имя:** Название модуля для отображения в UI (например, "Конвертер аудио") в различных локалях поддерживаемых самим приложением (английский язык обязателен, т.к. является fallback-вариантом).
	    - **Локализуемое описание (опционально):** Краткое описание функциональности модуля.
	    - **Иконка**: внутри ресурсов модуля/стандартная иконка Qt, которая будет использоваться для его представления в UI, может настраиваться извне и может отсутствовать
	- **F-ARCH-1-8 (Управление зависимостями):** В манифесте модуль **должен** объявлять свои зависимости. Для зависимости от Ядра должны быть указаны как минимум:    
	    - **Минимально требуемая версия Ядра** (min_core_version).
	    - **Версия Ядра, на которой проводилось тестирование** (tested_core_version).
	    - (Опционально) **Максимально поддерживаемая версия Ядра** (max_core_version).
	- **F-ARCH-1-9 (Проверка зависимостей):** "Подсистема управления модулями" при загрузке модуля должна выполнять следующие проверки:
	    - **F-ARCH-1-9-1:** Если текущая версия Ядра **ниже** min_core_version или **выше** max_core_version (если она указана), модуль **не загружается**, и регистрируется ошибка.
	    - **F-ARCH-1-9-2:** Если текущая версия Ядра **выше** tested_core_version, модуль **загружается**, но система должна **уведомить пользователя** о потенциальной нестабильности (например, через специальную пометку в менеджере модулей и/или однократное уведомление).
	- **F-ARCH-1-10 (Обработка конфликтов):** В случае конфликта строковых идентификаторов, система должна уведомить пользователя и предоставить ему возможность разрешить конфликт (например, отключив один из конфликтующих модулей). UUID в данном случае служит для точной идентификации файлов модулей.
- **F-ARCH-2: Шина событий**
    - F-ARCH-2-1: Ядро должно предоставлять централизованную **шину событий** для асинхронного обмена сообщениями, обеспечивая слабую связанность между модулями.
    - F-ARCH-2-2: Модули должны иметь возможность публиковать события и подписываться на них.
- **F-ARCH-3: Служба хранения (Persistence)**
    - F-ARCH-3-1: Ядро должно предоставлять абстрактный слой для работы с **единой базой данных** приложения.
    - F-ARCH-3-2: Служба должна предоставлять **опциональным модулям** API для создания и управления собственными таблицами и данными.
    - F-ARCH-3-3 (уточнено): Для обеспечения **изоляции и предотвращения конфликтов**, все таблицы, создаваемые опциональным модулем, должны автоматически помещаться в **уникальное пространство имен** (например, путем добавления префикса имя_модуля_ к именам таблиц).
    - F-ARCH-3-4: API службы хранения должен поддерживать все основные типы данных, включая текстовые и бинарные (BLOB).
    - F-ARCH-3-5: Ядро должно управлять миграциями схемы БД как для своих таблиц, так и предоставлять механизм для миграций, объявленных модулями.
- **F-ARCH-4: Служба метаданных**
    - F-ARCH-4-1: Ядро должно предоставлять сервис, являющийся **единственным компонентом**, ответственным за чтение и запись метаданных из/в аудиофайлы.
    - F-ARCH-4-2: Сервис должен предоставлять метаданные в **едином, стандартизированном внутреннем формате**, абстрагируясь от конкретных форматов тегов (ID3, Vorbis и т.д.).
    - F-ARCH-4-3: Сервис должен уметь **вычислять и кэшировать акустический отпечаток (Chromaprint)** как часть стандартных метаданных.
- **F-ARCH-5: Служба конфигурации**
    - F-ARCH-5-1: Ядро должно предоставлять API для **чтения и записи настроек** приложения и модулей.
    - F-ARCH-5-2: Модули должны **декларативно описывать** свои настройки (имя, тип, значение по умолчанию), на основе чего **Базовый модуль "Настройки"** автоматически генерирует UI для их редактирования.
- **F-ARCH-6: Служба глобальных сочетаний клавиш**
    - F-ARCH-6-1: Ядро должно предоставлять сервис для **регистрации и прослушивания глобальных сочетаний клавиш**.
    - F-ARCH-6-2: Модули должны иметь возможность регистрировать в этой службе желаемые действия и запрашивать у пользователя назначение для них сочетаний клавиш через **Базовый модуль "Настройки"**.
- **F-ARCH-7: Общий инструментарий для модулей (Framework Utilities)**
    - **F-ARCH-7-1 (Библиотека UI-компонентов):** Ядро (или Базовый модуль "Каркас") должно предоставлять модулям доступ к **набору стандартных, стилизованных UI-компонентов**, специфичных для приложения. Это должно включать как минимум:
        - **Стандартизированный компонент для отображения списка треков** (тот самый, что мы обсуждали для библиотеки и плейлистов).
        - Общие диалоговые окна (выбор файла, подтверждение, сообщение об ошибке).
        - Стилизованные кнопки, поля ввода и другие базовые виджеты.
    - **F-ARCH-7-2 (Утилитарные библиотеки):** Ядро должно предоставлять модулям набор **общих "хелперов" и утилит** для выполнения частых задач, например:
        - Логирование;
        - Работа с файловой системой (кроссплатформенные обертки);
        - Работа со строками и локализацией;
        - Упрощенный HTTP-клиент для сетевых запросов;
        - Создание UUID;
        - И так далее.
    - **F-ARCH-7-3 (Принцип использования):** Модули **должны** использовать эти общие компоненты и утилиты, где это возможно, для обеспечения **консистентности, стабильности и уменьшения дублирования кода**.

### 3.1.11 Дополнение: Каркас приложения

- **F-SHELL-1: Управление рабочим пространством**
    - F-SHELL-1-1: Модуль должен создавать главное окно приложения, включая главное меню, панели инструментов и статус-бар.
    - F-SHELL-1-2: "Каркас" должен обнаруживать все загруженные модули, реализующие интерфейс UI (IUserInterfaceModule), и предоставлять пользователю способы их активации.
	- F-SHELL-1-3: UI модулей должны открываться в виде **вкладок (панелей)** в основной рабочей области. Пользователь должен иметь возможность закрывать эти вкладки и менять их порядок.
	    - - **F-SHELL-1-3-1 (Отображение иконок на вкладках):** На каждой вкладке, рядом с ее названием, должна отображаться **иконка**, соответствующая модулю.    
		- **F-SHELL-1-3-2 (Настройка отображения):** Пользователь должен иметь возможность в настройках приложения выбрать режим отображения вкладок: "Иконка и текст", "Только иконка" (для компактности), "Только текст".
    - F-SHELL-1-4: Доступ к открытию панелей модулей должен предоставляться как минимум через **главное меню** ("Модули -> Открыть...") и через специальную **панель-"Каталог"**.
    - F-SHELL-1-5: Панель-"Каталог" сама является вкладкой, которую нельзя закрыть, и служит для отображения списка всех доступных для активации UI-модулей.
    - F-SHELL-1-6: Состояние рабочего пространства (открытые вкладки и их расположение) должно опционально сохраняться между сессиями приложения.
    - F-SHELL-1-7: Панель-"Каталог" должна предоставлять быстрый доступ (например, через контекстное меню) к **просмотру информации** о модуле. Эта функция должна быть реализована путем отправки запроса в Шину событий, который обрабатывается **Модулем "Настройки"**.
- **F-SHELL-2: Использование статус-бара**
    - F-SHELL-2-1: Главное окно приложения должно содержать **статус-бар** для отображения контекстной информации и статуса фоновых операций.
    - F-SHELL-2-2: Статус-бар должен отображать **прогресс и состояние** длительных фоновых задач (например, "Сканирование источников...").
    - F-SHELL-2-3: После завершения операций статус-бар должен на короткое время отображать **сводный результат** (например, "50 файлов успешно сконвертировано").        
    - F-SHELL-2-4: При выделении треков в библиотеке статус-бар должен отображать **информацию о выделении** (количество треков, общая длительность).
    - F-SHELL-2-5: Статус-бар должен отображать информацию о **статусе загрузки модулей** при запуске приложения.
        - F-SHELL-2-5-1: Сообщение должно включать количество **успешно загруженных** модулей и количество **ошибок**. Количество намеренно отключенных модулей отображаться не должно.
        - F-SHELL-2-5-2: Если при загрузке произошли ошибки, сообщение в статус-баре должно быть **визуально выделено и интерактивно**, предоставляя быстрый доступ к детальному логу ошибок.

<a name="nf-req"/>

## 3.2. Нефункциональные требования

<a name="nf-quality"/>

### 3.2.1 Атрибуты качества

<a name="nf-use"/>

#### 3.2.1.1 Требования к удобству использования
- **NF-USE-1 (Низкий порог входа):** При первом запуске приложение должно предоставлять пользователю понятный процесс начальной настройки (onboarding), который поможет добавить музыку в библиотеку и познакомит с основными элементами интерфейса.
- **NF-USE-2 (Принцип наименьшего удивления):** Интерфейс должен быть спроектирован так, чтобы расположение и назначение основных элементов управления (добавление треков, воспроизведение, поиск) были очевидны для пользователя, знакомого с другими медиа-приложениями.
- **NF-USE-3 (Контекстно-зависимые настройки):** Для сложных элементов интерфейса (например, панель фильтрации, настройки модуля) должна быть предусмотрена возможность быстрого доступа к соответствующему разделу настроек непосредственно из самого элемента (например, через иконку "шестеренки").
- **NF-USE-4 (Обнаруживаемость функций):** Все доступные модули, включая отключенные, должны быть легко обнаруживаемы пользователем из основного интерфейса, без необходимости углубляться в меню настроек.
- **NF-USE-5 (Визуализация пакетных операций):** Для всех длительных пакетных операций (конвертация, обновление тегов и т.д.) должен использоваться **сегментированный прогресс-бар**. Этот компонент должен визуально разделять всю задачу на отдельные подзадачи (файлы) и отображать их индивидуальный статус с помощью цветовой кодировки (ожидание, в процессе, успех, ошибка).
- **NF-USE-6 (Детализация результатов операции):** Рядом с сегментированным прогресс-баром должна находиться точка доступа (например, кнопка "Подробнее...") к окну с детальными результатами операции, где отображается полный список обработанных файлов и их статус.
- **NF-USE-7 (Инструменты для анализа результатов):** Окно с результатами операции должно предоставлять пользователю инструменты для **фильтрации** (например, "показать только ошибки") и **сортировки** списка для удобного анализа.

<a name="nf-sec"/>

#### 3.2.1.2 Требования к безопасности  
- **NF-SEC-1 (Безопасность данных):** Приложение **не должно** отправлять в сеть никакую идентифицирующую пользователя информацию или данные из его библиотеки, за исключением анонимизированных запросов к онлайн-сервисам (например, MusicBrainz), которые необходимы для работы функций.
- **NF-SEC-2 (Целостность файлов):** Операции, изменяющие файлы пользователя (запись тегов, переименование), должны быть реализованы таким образом, чтобы минимизировать риск повреждения файла в случае сбоя (например, путем записи во временный файл с последующей заменой).

<a name="nf-perf"/>

#### 3.2.1.3 Требования к производительности
- **NF-PERF-1 (Отзывчивость UI):** Пользовательский интерфейс должен оставаться отзывчивым (не "зависать") во время выполнения любых длительных фоновых операций (сканирование библиотеки, конвертация и т.д.)
- **NF-PERF-2 (Масштабируемость библиотеки):** Базовые операции (поиск, фильтрация) в библиотеке размером 10,000 треков должны выполняться за время, не превышающее 3-4 секунды.
- **NF-PERF-3 (Потребление ресурсов):** В фоновом режиме, когда не выполняются активные операции (в том числе синхронизация источников), приложение должно потреблять минимальное количество ресурсов ЦП и разумное количество ОЗУ, хотя бы не более 400мб за исключением базы данных   
- **NF-PERF-4 (Скорость запуска):** Приложение должно запускаться ("холодный старт") за приемлемое время, предположительно:
    1. Основной интерфейс - 1-3 секунды 
    2. Основные данные (база данных аудиофайлов, фильтры, и т.д.) - <=5 секунд
    3. Остальное - хотя бы <20 секунд

<a name="nf-rel"/>

#### 3.2.1.4 Требования к надежности  
- **NF-REL-1 (Изоляция модулей):** Ошибка или сбой в одном **опциональном модуле** не должен приводить к аварийному завершению работы всего приложения. Ядро должно перехватить ошибку и, по возможности, предложить отключить проблемный модуль.
- **NF-REL-2 (Обработка "битых" файлов):** Приложение должно корректно обрабатывать поврежденные или некорректно сформированные аудиофайлы, не "падая", а перемещая их в отдельную категорию фильтрации, с названием по типу "Некорректные файлы"
- **NF-REL-3 (Сохранение состояния):** Приложение должно корректно сохранять свое состояние (размер и положение окна, текущий плейлист, настройки) между сессиями.

<a name="nf-comp"/>

#### 3.2.1.5 Требования к совместимости
- **NF-COMP-1 (Платформа):** Приложение должно корректно функционировать на основных дистрибутивах **GNU/Linux** с современными версиями рабочего окружения GNOME и KDE.
- **NF-COMP-2 (Зависимости):** Приложение должно явно документировать свои зависимости от версий системных библиотек (например, Qt, GStreamer), чтобы обеспечить предсказуемую работу.

<a name="nf-loc"/>

### 3.2.1.6 Требования к локализации (Localization)

- **NF-LOC-1 (Поддерживаемые языки):** Приложение должно поддерживать как минимум два языка: **английский** и **русский**. Английский язык является языком по умолчанию (fallback).
- **NF-LOC-2 (Локализация интерфейса):** Все текстовые строки, видимые пользователю в интерфейсе (метки, кнопки, меню, сообщения), должны быть вынесены во внешние ресурсы для обеспечения возможности перевода
- **NF-LOC-3 (Локализация данных):** Система должна предоставлять механизм для локализации **отображения** определенных значений, полученных из метаданных аудиофайлов. Сами теги в файлах при этом **не изменяются**. Этот механизм должен включать в себя:
    - **NF-LOC-3-1 (Маппинг жанров):** Возможность сопоставления стандартных (как правило, англоязычных) названий жанров с их локализованными эквивалентами (например, "Symphonic Rock" -> "Симфонический рок").
    - **NF-LOC-3-2 (Обработка конвенциональных значений):** Возможность распознавать и локализовать общепринятые значения в тегах, такие как название альбома "Single" (-> "Сингл").
- **NF-LOC-4 (Выбор языка):** По умолчанию приложение должно пытаться использовать язык, установленный в операционной системе. Пользователь должен иметь возможность **принудительно выбрать** любой из поддерживаемых языков в настройках приложения.

<a name="nf-ei"/>

### 3.2.2. Внешние интерфейсы
- **NF-EI-1 (Программный интерфейс (API) для модулей):** Система должна предоставлять стабильный, документированный **внутренний API**, который модули используют для взаимодействия с Ядром и друг с другом. Ядро определяет набор стандартных интерфейсов (например, IUserInterfaceModule, IAudioConversionProvider), которые модули могут реализовывать. Также, модули могут объявлять свои интерфейсы, которые могут реализовывать другие модули
- **NF-EI-2 (Интерфейс взаимодействия с онлайн-сервисами):** Система взаимодействует с внешними веб-сервисами (такими как MusicBrainz) через их публичные REST/JSON API по протоколу HTTP(S).
- **NF-EI-3 (Интерфейс взаимодействия с файловой системой):** Система использует стандартные системные вызовы POSIX для работы с файлами, а также специфичные для Linux API (Inotify/Fanotify) для мониторинга в реальном времени.
- **NF-EI-4 (Интерфейс взаимодействия с устройствами):** Для идентификации съемных устройств система использует информацию, предоставляемую подсистемой udev (в частности, UUID и метки томов). Для доступа к файлам на устройствах используется стандартный интерфейс монтирования файловых систем.
- **NF-EI-5 (Интерфейс интеграции с рабочим столом):** Система интегрируется со стандартными рабочими окружениями Linux через протокол **MPRIS D-Bus**.

<a name="nf-con"/>

### 3.2.3. Ограничения
- **NF-CON-1 (Платформа):** Первоначальная версия приложения разрабатывается и тестируется исключительно для платформы **GNU/Linux**. Поддержка других операционных систем (Windows, macOS) не входит в рамки текущей версии.
- **NF-CON-2 (Технологический стек):** Пользовательский интерфейс приложения должен быть реализован с использованием фреймворка **Qt (через C++)**.
- **NF-CON-3 (Лицензирование):** Приложение должно быть выпущено под одной из свободных/открытых лицензий (FOSS), совместимых с лицензиями используемых библиотек (например, GPL, MIT). 
- **NF-CON-4 (Язык):** Основным языком пользовательского интерфейса является русский и английский.
